<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>sort</title>
</head>
<style>
	body{
		text-align: center;
	}
	.wrapper{
		width:500px;
		margin:0 auto;
		display: flex;
		align-items:flex-end;
	}
	.list{
		width: 5px;
		float:left;
		background: green;
		margin-right:3px;
	}
	button{
		margin-top: 40px;
	}
</style>
<body>
    <div class="wrapper">
        <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
    	<div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
	    <div class="list"></div>
    </div>
    <button class="bubble-sort">冒泡</button>
    <button class="selection-sort">选择</button>
    <button class="quick-sort">快排</button>
	<script src='lib/index.js'></script>
	<script>
		(function() {
			let lists = document.querySelectorAll('.list');
			Array.prototype.slice.call(lists).forEach(function(list) {
				list.style.height = Math.floor(Math.random()*200) + 'px';
			})

		})()

		let buttons = document.querySelectorAll('button');
		Array.prototype.slice.call(buttons).forEach(function(button) {
			button.addEventListener('click',function(){
				let sortter = sort(this.className);
				(function swap() {
					if (sortter.next().done) {
						return;
					} else {
						var result = sortter.next()
						if (result.value[0]) {
							if (flag) {
								animation(result.value[1],result.value[2]);
							};
							swap();
						};
						swap();
					}
				})();
			},false)
		})

		function* sort(type) {
			let array = [];
			let lists = document.querySelectorAll('.list');
			Array.prototype.slice.call(lists).forEach(function(list) {
				array.push(list.offsetHeight);	
			})
			switch (type)
			{
				case 'bubble-sort':
					break;
				case 'selection-sort':
					for (let i = 0; i <= lists.length - 1; i++) {
						for (let j = i + 1; j <= lists.length; j++) {
							let arr = [];
							arr.push(array[i] > array[j]);
							arr.push(i);
							arr.push(j);
							yield arr;
						};
					};
					break;
				case 'quick-sort':
					break;
			}
		}

		let flag = true;
		function animation(start,end) {
			flag = false;
			let lists = document.querySelectorAll('.list');
			let temp;
			lists = Array.prototype.slice.call(lists);
			temp = lists[start].offsetHeight;
			// logger([lists[start].offsetHeight,lists[end].offsetHeight])
			lists[start].style.height = lists[end].offsetHeight + 'px';
			lists[end].style.height = temp + 'px';
			flag = true;
		}
		function logger(context) {
			return console.log.apply(console,[context]);
		}
	</script>
</body>
</html>